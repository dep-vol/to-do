(this["webpackJsonpto-do"]=this["webpackJsonpto-do"]||[]).push([[0],{16:function(e,t,a){e.exports={head:"header_head__2Yzzy",mainrow:"header_mainrow__30h4F",listCounter:"header_listCounter__1W6rT",tog:"header_tog__26H1Q",user:"header_user__LBWH_"}},29:function(e,t,a){e.exports=a(46)},34:function(e,t,a){},35:function(e,t,a){},36:function(e,t,a){},38:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(26),c=a.n(o),s=a(1),i=a(14),l=a(4),u=a(9),m=a(11),p=a(10),f=a(16),h=a.n(f),d=(a(34),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props,t=e.toDosList,a=e.hide,n=e.loadList,o=e.user,c=e.logout,s=!1===this.props.show?"hidden":"",i=t.map((function(e){return r.a.createElement("li",{className:"",onClick:function(){return n(o,e)},key:e},e)}));return r.a.createElement("div",{className:"mainList ".concat(s),onMouseLeave:a},r.a.createElement("h5",{className:"text-center"},"Saved lists:"),r.a.createElement("ul",null,i),r.a.createElement("span",{className:"badge  badge-primary",onClick:c},"Log out"))}}]),a}(n.Component)),b=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={show:!1},e.togglePopup=function(){var t=!e.state.show;e.setState({show:t})},e.hidePopup=function(){e.setState({show:!1})},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props,t=e.total,a=e.doneItemsCount,n=e.toDosList,o=e.onLoadList,c=e.user,s=e.logout;return r.a.createElement("div",{className:"container-fluid ".concat(h.a.head)},r.a.createElement("div",{className:"row ".concat(h.a.mainrow)},r.a.createElement("div",{className:"col"},r.a.createElement("h1",{className:"text-center"},"ToDo-application"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col ".concat(h.a.user)},r.a.createElement("div",{className:h.a.tog},r.a.createElement("div",null,"".concat(c," :")),r.a.createElement("i",{className:"fa fa-bars","aria-hidden":"true",onClick:this.togglePopup}),r.a.createElement(d,{show:this.state.show,toDosList:n,hide:this.hidePopup,loadList:o,user:c,logout:s}))),r.a.createElement("div",{className:"col"},r.a.createElement("ul",{className:h.a.listCounter},r.a.createElement("li",null,"Uncompleted ",r.a.createElement("span",{className:"badge badge-primary"},t-a)),r.a.createElement("li",null,"Completed ",r.a.createElement("span",{className:"badge badge-primary"},a)),r.a.createElement("li",null,"Total to-dos ",r.a.createElement("span",{className:"badge badge-primary"},t))))))}}]),a}(n.Component),g=(a(35),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={show:!1,inpValue:""},e.checkComplete=function(e){return e.done?"itemDone":""},e.togglePopup=function(){var t=!e.state.show;e.setState({show:t})},e.changeName=function(t){e.props.toDosList.includes(t)||(e.props.changeName(t),e.togglePopup())},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.listItems,n=t.deleteItem,o=t.complete,c=t.listName,s=a.map((function(t,a){return r.a.createElement("li",{className:"list-group-item ".concat(e.checkComplete(t)),key:t.id+"item"},"".concat(a+1,". ").concat(t.title),r.a.createElement("i",{className:"fa fa-check ".concat(e.checkComplete(t)),"aria-hidden":"true",onClick:function(){return o(t.id)}}),r.a.createElement("i",{className:"fa fa-trash-o","aria-hidden":"true",onClick:function(){return n(t.id)}}))})),i=!1===this.state.show?"hidden":"";return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row mt-3 mb-3"},r.a.createElement("div",{className:"col"},r.a.createElement("h3",{className:"text-center"},""===c?"Unnamed list":c,":",r.a.createElement("sup",null,r.a.createElement("i",{className:"fa fa-pencil-square-o fa-edit","aria-hidden":"true",onClick:this.togglePopup})),r.a.createElement("sup",null,r.a.createElement("i",{className:"fa fa-floppy-o fa-edit","aria-hidden":"true",onClick:this.props.save}))))),r.a.createElement("div",{className:"row center ".concat(i)},r.a.createElement("form",{className:"form-inline row addInput",onSubmit:function(e){return e.preventDefault()}},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Please, type new title",value:this.state.inpValue,onChange:function(t){e.setState({inpValue:t.target.value})}}),r.a.createElement("button",{className:"btn btn-self",onClick:function(){return e.changeName(e.state.inpValue)}},"Rename")))),r.a.createElement("div",{className:"row center"},r.a.createElement("div",{className:"col-5"},r.a.createElement("ul",{className:"list-group"},s))))}}]),a}(n.Component)),E=(a(36),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={inpValue:""},e.inpChange=function(t){var a=t.target.value;if(""===a&&null===a)return null;e.setState({inpValue:a})},e.onAddItem=function(){e.props.addItem(e.state.inpValue)},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this.state.inpValue;return r.a.createElement("form",{className:"form-inline row addInput",onSubmit:function(e){return e.preventDefault()}},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Please, type toDo",value:e,onChange:this.inpChange}),r.a.createElement("button",{className:"btn btn-self",onClick:this.onAddItem,disabled:""===e},"Add")))}}]),a}(n.Component)),v=a(21),j=a.n(v),O=a(27),y=function(){var e=Object(O.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://thingproxy.freeboard.io/fetch/".concat(t,"/save.php"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({})});case 2:return a=e.sent,e.abrupt("return",a.ok);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function e(){var t=this;Object(l.a)(this,e),this.host=y("https://market-try.000webhostapp.com/api")?"https://market-try.000webhostapp.com/api/":y("http://f0442974.xsph.ru")?"http://f0442974.xsph.ru/":null,this.BASE_URL="https://thingproxy.freeboard.io/fetch/".concat(this.host),this.apiError="",this.apiMsg="",this.loadToDoList=function(e){return fetch("".concat(t.BASE_URL,"load.php?data=").concat(e)).then((function(e){return e.json()})).catch((function(e){return t.apiError=e.message}))},this.loadList=function(e,a){return fetch("".concat(t.BASE_URL,"load.php?data=").concat(e,"&list=").concat(a)).then((function(e){return e.json()})).catch((function(e){return t.apiError=e.message}))},this.saveToDo=function(e){return fetch("".concat(t.BASE_URL,"save.php"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((function(e){return e.text()})).then((function(e){if(t.apiMsg=e,""===e)throw new Error("Error on server please try later")})).catch((function(e){return t.apiError=e.message}))},this.register=function(e){var a=new FormData(e);fetch("".concat(t.BASE_URL,"reg.php"),{method:"POST",body:a}).then((function(e){return e.text()})).then((function(e){if(t.apiMsg=e,""===e)throw new Error("Error on server please try later")})).catch((function(e){return console.error(e)}))},this.checkUsernameExist=function(e){return fetch("".concat(t.BASE_URL,"reg.php?nick=").concat(e)).then((function(e){return e.text()})).then((function(t){if("TRUE"===t)throw new Error("User with nickname ".concat(e," is already exist"))})).catch((function(e){return e.message}))},this.checkUserMailExist=function(e,a){return fetch("".concat(t.BASE_URL,"reg.php?mail=").concat(e)).then((function(e){return e.text()})).then((function(t){if("TRUE"===t){if("login"===a)return"ok";throw new Error("User with E-mail ".concat(e," is already exist"))}if(a)return"User with E-mail ".concat(e," does not exist. Please register")})).catch((function(e){return e.message}))},this.checkUserPass=function(e,a){return fetch("".concat(t.BASE_URL,"reg.php?mail=").concat(a,"&pass=").concat(e)).then((function(e){return e.text()})).then((function(e){return"TRUE"===e?"ok":"Password or Email does not correct"})).catch((function(e){return e.message}))},this.getLoggedUser=function(e){return fetch("".concat(t.BASE_URL,"reg.php?mail=").concat(e,"&getU=true")).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return e.message}))}},w=(a(38),r.a.createContext({})),k=w.Provider,C=(w.Consumer,a(15)),S=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).apiConnect=new N,e.userStorage=JSON.parse(localStorage.getItem("user")),e.state={toDos:[],toDoName:"",toDosList:[],popup:{title:"",show:!1,type:""},loggedUser:{name:""}},e.onToggleDone=function(t){var a=Object(i.a)(e.state.toDos),n=a.findIndex((function(e){return e.id===t})),r=Object(s.a)({},a[n]);a[n]=Object(s.a)(Object(s.a)({},r),{},{done:!r.done}),e.setState({toDos:a})},e.onDelete=function(t){var a=Object(i.a)(e.state.toDos),n=a.findIndex((function(e){return e.id===t}));a.splice(n,1),e.setState({toDos:a})},e.onAddItem=function(t){var a=Object(i.a)(e.state.toDos),n={id:a.length+1,title:t,done:!1};a.push(n),e.setState({toDos:a})},e.onChangeToDoName=function(t){e.setState({toDoName:t})},e.onSave=function(){var t={toDos:Object(i.a)(e.state.toDos),name:e.state.toDoName,user:e.state.loggedUser.name};if(""!==t.name)e.apiConnect.saveToDo(t).then((function(){""!==e.apiConnect.apiError?e.onError(!0,e.apiConnect.apiError):(e.onSuccess(!0,e.apiConnect.apiMsg),e.loadSavedLists(e.userStorage.nickname))}));else{e.onError(!0,"Please choose a name of the list")}},e.onError=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.state.popup.title,n=Object(s.a)({},e.state.popup);n.title=a,n.show=t,n.type="error",e.setState({popup:n}),setTimeout((function(){return e.closeError()}),2500)},e.onSuccess=function(t,a){var n=Object(s.a)({},e.state.popup);n.title=a,n.show=t,n.type="Success!",e.setState({popup:n}),setTimeout((function(){return e.closeError()}),2500)},e.loadList=function(t,a){e.apiConnect.loadList(t,a).then((function(t){""!==e.apiConnect.apiError?e.onError(!0,e.apiConnect.apiError):e.setState({toDos:t.toDos,toDoName:t.name})}))},e.closeError=function(){var t=Object(s.a)({},e.state.popup);t.show=!1,e.setState({popup:t})},e.onLogOut=function(){e.context.logIn(),localStorage.clear(),e.setState(Object(s.a)(Object(s.a)({},e.state),{},{loggedUser:{name:""}}))},e}return Object(u.a)(a,[{key:"loadSavedLists",value:function(e){var t=this;this.apiConnect.loadToDoList(e).then((function(e){null!==e&&(""!==t.apiConnect.apiError?t.onError(!0,t.apiConnect.apiError):t.setState({toDosList:e}))}))}},{key:"componentDidMount",value:function(){var e=this;(this.context.isLogged||this.userStorage)&&(this.setState((function(){return Object(s.a)(Object(s.a)({},e.state),{},{loggedUser:Object(s.a)(Object(s.a)({},e.state.loggedUser),{},{name:e.userStorage.nickname})})})),this.loadSavedLists(this.userStorage.nickname))}},{key:"render",value:function(){var e=this.state,t=e.toDos,a=e.toDoName,n=e.toDosList,o=e.popup;return""===this.state.loggedUser.name?r.a.createElement("div",{className:"d-flex flex-column justify-content-center align-items-center logIn"},r.a.createElement("h3",null,"Please logIn!"),r.a.createElement(C.b,{to:"/"},"Go to authorization page")):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement(b,{total:t.length,doneItemsCount:t.filter((function(e){return!0===e.done})).length,toDosList:n,onLoadList:this.loadList,user:this.state.loggedUser.name,logout:this.onLogOut}),r.a.createElement(g,{listItems:t,deleteItem:this.onDelete,complete:this.onToggleDone,listName:a,changeName:this.onChangeToDoName,save:this.onSave,toDosList:n}),r.a.createElement(E,{addItem:this.onAddItem})),r.a.createElement("div",{className:"hideError",style:o.show?{opacity:1}:{}},r.a.createElement("h3",null,o.type),r.a.createElement("p",{className:"text-muted font-italic"},o.title),r.a.createElement("i",{className:"fa fa-times closeI","aria-hidden":"true",onClick:this.closeError})))}}]),a}(r.a.Component);S.contextType=w;var x=S,L=(a(44),a(8)),D=a(12),U=(a(45),r.a.forwardRef((function(e,t){var a=Object(n.useState)(""),o=Object(D.a)(a,2),c=o[0],s=o[1],i=e.validateType,l=e.validateCallback,u=e.type,m=e.name,p=e.label,f=e.onEnter;return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:m},p),r.a.createElement("input",{type:u,name:m,value:c,className:"form-control ".concat(i.status),onChange:function(e){return s(e.target.value)},onBlur:function(){return l(c)},onKeyPress:function(e){"Enter"===e.key&&(l(c),f())},ref:t}),r.a.createElement("div",{className:"invalid-feedback"},i.msg),r.a.createElement("div",{className:"valid-feedback"},"Looks good!"))}))),T=new N,I=function(e){var t=Object(n.useContext)(w),a=Object(n.useState)({mail:{input:"",status:"",msg:""},pass:{status:"",msg:""}}),o=Object(D.a)(a,2),c=o[0],l=o[1],u=Object(n.useState)(!0),m=Object(D.a)(u,2),p=m[0],f=m[1],h=Object(n.useRef)(null),d=Object(n.useRef)(null),b=function(e,t,a,n){t.apply(void 0,[a].concat(Object(i.a)(n))).then((function(t){if("ok"===t){var n=Object(s.a)(Object(s.a)({},c[e]),{},{status:"is-valid",input:a});l(Object(s.a)(Object(s.a)({},c),{},Object(L.a)({},e,n)))}else{var r,o=Object(s.a)(Object(s.a)({},c[e]),{},{status:"is-invalid",msg:t,input:a});l(Object(s.a)(Object(s.a)({},c),{},(r={},Object(L.a)(r,e,o),Object(L.a)(r,"pass",{status:"",msg:""}),r)))}if(""===a){var i=Object(s.a)(Object(s.a)({},c[e]),{},{status:""});l(Object(s.a)(Object(s.a)({},c),{},Object(L.a)({},e,i)))}}))};return Object(n.useEffect)((function(){"is-valid"===c.mail.status&&"is-valid"===c.pass.status?f(!1):f(!0)})),r.a.createElement("div",{className:"d-flex flex-column justify-content-center align-items-center auth"},r.a.createElement("form",null,r.a.createElement(U,{validateType:c.mail,validateCallback:function(e){return b("mail",T.checkUserMailExist,e,["login"])},type:"email",name:"email",label:"Email address",onEnter:function(){return d.current.focus()}}),r.a.createElement(U,{validateType:c.pass,validateCallback:function(e){return b("pass",T.checkUserPass,e,[c.mail.input])},type:"password",name:"password",label:"Password",ref:d,onEnter:function(){return h.current.focus()}}),r.a.createElement("button",{type:"button",className:"btn btn-primary",disabled:p,onClick:function(){T.getLoggedUser(c.mail.input).then((function(a){localStorage.setItem("user",JSON.stringify(a)),t.logIn(),e.history.push("/main")}))},ref:h},"Log in"),r.a.createElement("div",null,r.a.createElement("small",{className:"form-text text-muted"},"If we don`t registered yet. Please",r.a.createElement(C.b,{to:"/registration"}," click to register")))))},P=a(2),_=new N,R=function(e){var t=Object(n.useState)({nickname:{status:"",msg:"",input:""},mail:{status:"",msg:"",input:""},pass:{status:"",msg:"",input:""}}),a=Object(D.a)(t,2),o=a[0],c=a[1],i=Object(n.useState)(!0),l=Object(D.a)(i,2),u=l[0],m=l[1],p=Object(n.useState)(!1),f=Object(D.a)(p,2),h=f[0],d=f[1],b=r.a.createRef(),g=r.a.createRef(),E=r.a.createRef(),v=r.a.createRef(),j=r.a.createRef(),O=function(e,t,a){t(a).then((function(t){if(t){var n=Object(s.a)(Object(s.a)({},o[e]),{},{status:"is-invalid",msg:t});c(Object(s.a)(Object(s.a)({},o),{},Object(L.a)({},e,n)))}else{var r=Object(s.a)(Object(s.a)({},o[e]),{},{status:"is-valid",input:a,msg:""});c(Object(s.a)(Object(s.a)({},o),{},Object(L.a)({},e,r)))}if(""===a){var i=Object(s.a)(Object(s.a)({},o[e]),{},{status:""});c(Object(s.a)(Object(s.a)({},o),{},Object(L.a)({},e,i)))}}))};return Object(n.useEffect)((function(){"is-valid"===o.nickname.status&&"is-valid"===o.mail.status&&"is-valid"===o.pass.status?m(!1):m(!0)})),!0===h?r.a.createElement("div",{className:"d-flex flex-column justify-content-center align-items-center auth"},r.a.createElement("h3",null,"Thank you for registration. You can login now!")):r.a.createElement("div",{className:"d-flex flex-column justify-content-center align-items-center auth"},r.a.createElement("h3",{className:"mb-5 text-center"},"Thank you for choosing our app. Please register:"),r.a.createElement("form",{ref:b},r.a.createElement(U,{validateType:o.nickname,validateCallback:function(e){return O("nickname",_.checkUsernameExist,e)},type:"text",name:"nick",label:"Nickname",onEnter:function(){return g.current.focus()}}),r.a.createElement(U,{validateType:o.mail,validateCallback:function(e){return O("mail",_.checkUserMailExist,e)},type:"email",name:"mail",label:"Email address",ref:g,onEnter:function(){return E.current.focus()}}),r.a.createElement(U,{validateType:o.pass,validateCallback:function(e){var t=Object(s.a)(Object(s.a)({},o.pass),{},{status:"",input:e});c(Object(s.a)(Object(s.a)({},o),{},{pass:t}))},type:"password",name:"password",label:"Password",ref:E,onEnter:function(){return v.current.focus()}}),r.a.createElement(U,{validateType:o.pass,validateCallback:function(e){if(e===o.pass.input){var t=Object(s.a)(Object(s.a)({},o.pass),{},{status:"is-valid"});c(Object(s.a)(Object(s.a)({},o),{},{pass:t}))}else{var a=Object(s.a)(Object(s.a)({},o.pass),{},{status:"is-invalid",msg:"Password is not similar"});c(Object(s.a)(Object(s.a)({},o),{},{pass:a}))}},type:"password",name:"PasswordCheck",label:"Repeat password",ref:v,onEnter:function(){return j.current.focus()}}),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(t){t.preventDefault(),_.register(b.current),d(!0),setTimeout((function(){return e.history.push("/")}),2e3)},ref:j,disabled:u},"Register")))};c.a.render(r.a.createElement(k,{value:new function e(){var t=this;Object(l.a)(this,e),this.isLogged=!1,this.logIn=function(){t.isLogged=!t.isLogged}}},r.a.createElement(C.a,null,r.a.createElement(P.a,{path:"/",component:I,exact:!0}),r.a.createElement(P.a,{path:"/registration",component:R,exact:!0}),r.a.createElement(P.a,{path:"/main",component:x,exact:!0}))),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.aa2cec5b.chunk.js.map